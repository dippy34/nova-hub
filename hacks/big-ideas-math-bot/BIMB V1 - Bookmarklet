javascript:(function(){try{if(window.__gpCleanup){try{window.__gpCleanup()}catch(_){}}var __gpOverlay=null,__gpList=null,__gpVisible=true,__gpKeyHandler=null;window.__gpCleanup=function(){if(__gpKeyHandler){window.removeEventListener('keydown',__gpKeyHandler);__gpKeyHandler=null}if(__gpOverlay&&__gpOverlay.parentNode){__gpOverlay.parentNode.removeChild(__gpOverlay)}__gpOverlay=null;__gpList=null;__gpVisible=false};__gpKeyHandler=function(e){if((e.key===','||e.code==='Comma')&&__gpOverlay){__gpVisible=!__gpVisible;__gpOverlay.style.display=__gpVisible?%27block%27:%27none%27;e.preventDefault()}if((e.key===%27.%27||e.code===%27Period%27)&&__gpOverlay){window.__gpCleanup();e.preventDefault()}};window.addEventListener(%27keydown%27,__gpKeyHandler);function ensureGraphOverlay(){if(__gpOverlay)return __gpOverlay;__gpOverlay=document.createElement(%27div%27);__gpOverlay.id=%27gp-overlay%27;__gpOverlay.style.cssText=%27position:fixed;top:80px;right:20px;min-width:120px;max-width:260px;max-height:40vh;overflow:auto;background:transparent;color:#000;font:bold 12px/1.35 ui-monospace,Menlo,Consolas,monospace;border-radius:4px;padding:4px 6px;cursor:grab;z-index:999999;user-select:none;border:none;';__gpList=document.createElement('div');__gpList.style.cssText='white-space:pre;margin:0;padding:0;';__gpOverlay.appendChild(__gpList);document.body.appendChild(__gpOverlay);(function(el){var dragging=false,sx=0,sy=0,ox=0,oy=0;el.addEventListener('mousedown',function(e){e.preventDefault();dragging=true;el.style.cursor='grabbing';sx=e.clientX;sy=e.clientY;ox=el.offsetLeft;oy=el.offsetTop;function move(ev){if(!dragging)return;el.style.left=(ox+(ev.clientX-sx))+'px';el.style.top=(oy+(ev.clientY-sy))+'px';el.style.right='auto'}function up(){dragging=false;el.style.cursor='grab';window.removeEventListener('mousemove',move);window.removeEventListener('mouseup',up)}window.addEventListener('mousemove',move);window.addEventListener('mouseup',up)})})(__gpOverlay);return __gpOverlay}function showGraphPointsOverlay(points,sawGraph){if(!sawGraph)return;ensureGraphOverlay();__gpList.textContent=points.length?points.map(function(p){return '('+p.x+', '+p.y+')'}).join('\n'):'(no point coordinates found)';__gpOverlay.style.display='block';__gpVisible=true}function getQuestion(){var api=window.LearnosityAssess;if(!api||!api.getCurrentItem){alert('Learnosity not ready');return}var cur=api.getCurrentItem();if(!cur||!cur.questions){alert('No questions found');return}var qs=cur.questions,output='',graphPoints=[],sawGraph=false;for(var i=0;i<qs.length;i++){var q=qs[i],t=q&&q.type;if(t==='clozeassociation'){var v1=q.validation&&q.validation.valid_response&&q.validation.valid_response.value||[];for(var a=0;a<v1.length;a++){output+=String(v1[a])+'\n'}}else if(t==='clozeformula'){var v2=q.validation&&q.validation.valid_response&&q.validation.valid_response.value||[];for(var b=0;b<v2.length;b++){output+=String((v2[b]&&v2[b][0]&&v2[b][0].value)||'')+'\n'}}else if(t==='longtypeV2'||t==='longtextV2'){output+='cant be done use google or smth\n'}else if(t==='mcq'){var v3=q.validation&&q.validation.valid_response&&q.validation.valid_response.value||[];for(var c=0;c<v3.length;c++){var letter=['A','B','C','D'][v3[c]];output+=(letter!=null?letter:v3[c])+'\n'}}else if(t==='clozedropdown'){var v4=q.validation&&q.validation.valid_response&&q.validation.valid_response.value||[];for(var d=0;d<v4.length;d++){output+=String(v4[d])+'\n'}}else if(t==='graphplotting'){sawGraph=true;var v5=q.validation&&q.validation.valid_response&&q.validation.valid_response.value||[];for(var e=0;e<v5.length;e++){var s=v5[e];if(!s)continue;if(s.type==='point'){var c0=s.coords,x=(Object.prototype.toString.call(c0)==='[object Array]')?c0[0]:(c0&&c0.x),y=(Object.prototype.toString.call(c0)==='[object Array]')?c0[1]:(c0&&c0.y);if(isFinite(x)&&isFinite(y)){graphPoints.push({x:x,y:y});continue}}if(s.point&&isFinite(s.point.x)&&isFinite(s.point.y)){graphPoints.push({x:s.point.x,y:s.point.y});continue}if(Object.prototype.toString.call(s)==='[object Array]'&&s.length>=2&&isFinite(s[0])&&isFinite(s[1])){graphPoints.push({x:s[0],y:s[1]});continue}}}}var txt=(output||'').replace(/^\s+|\s+$/g,'');if(txt){alert(txt)}showGraphPointsOverlay(graphPoints,sawGraph)}(function wait(){try{if(window.LearnosityAssess&&window.LearnosityAssess.getCurrentItem){getQuestion()}else{setTimeout(wait,100)}}catch(_){setTimeout(wait,200)}})()}catch(err){alert('Bookmarklet error: '+(err&&err.message||err));console.error(err)}})();
