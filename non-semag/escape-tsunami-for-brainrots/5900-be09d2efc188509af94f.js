(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5900],{4014:function(){var e,t,n,i,o,r,s,a,c,u,h,l,d,f,m,p=(e=null,t=null,n=null,i=!1,o=1,r=function(){i||s(),$(".choose-avatar-popup").find(".error").hide(),$(".choose-avatar-popup").show()},s=function(){h(),a(),l(),$(".btn-confirm").on("click",f),$(".btn-upload").on("click",m),i=!0},a=function(){$(".avatar-preset-wrapper").on("click",(function(){var t=$(this).data("id");e==t?c():t&&u(t,$(this))})),$(".set-"+o).show()},c=function(){e=null,$(".btn-confirm").addClass("disabled"),$(".avatar-preset-wrapper").removeClass("active"),$(".avatar-preset-wrapper").removeClass("dimmed")},u=function(t,n){e=t,$(".avatar-preset-wrapper").removeClass("active"),n.addClass("active"),n.removeClass("dimmed"),$(".avatar-preset-wrapper:not(.active)").addClass("dimmed"),$(".btn-confirm").removeClass("disabled")},h=function(){$(".choose-avatar-popup .btn-close").on("click",(function(e){e.preventDefault(),$(".choose-avatar-popup").hide()}))},l=function(){$(".choose-avatar-popup .btn-refresh").on("click",d)},d=function(){c(),$(".set-"+o).hide(),o=o<9?o+1:1,$(".set-"+o).fadeIn()},f=function(n){n.preventDefault(),e&&$.ajax({url:"/ajax/choose_avatar_preset",data:{choise:e},method:"POST",timeout:1e4}).done((function(e){1==e.success&&(t(),$(".choose-avatar-popup").hide())})).fail((function(){$(".choose-avatar-popup").find(".error").show()}))},m=function(e){e.preventDefault();var i=window.appInfo.accountServiceApiUrls.profilePictureUrl.replace(":uid",n);window.open(i,"_blank"),window.focus(),$(".choose-avatar-popup").hide(),t()},{init:function(e){if(t=e,n=Cookies.get("user_pid"),-1===$(".avatar").prop("src").indexOf("default")||!n)return t();$.ajax({url:window.appInfo.accountServiceApiUrls.profileJsonUrl.replace(":uid",n),timeout:1e4}).done((function(e){e&&e.profile&&1!=e.profile.avatar_present?r():t()})).fail((function(){t()}))}});window.AvatarChooser=p},9520:function(){var e={init:function(){$(document).ready((function(){var e=$("#achitem-popup"),t=$("#achitem-title"),n=$("#achitem-desc"),i=$("#achitem-difficulty"),o=$("#achitem-awarded");$(document).on({mouseenter:function(){var r=$(this),s=$(".idnet-achievements").offset(),a=r.offset(),c=r.outerWidth(),u=r.outerHeight(),h=e.outerWidth(),l=e.outerHeight(),d=a.left-s.left+c/2-h/2,f=a.top-s.top+u/2-l/2;t.html(r.data("achtitle")),n.html(r.data("achdesc")),i.html(r.data("achdifficulty"));var m=r.data("achawarded");o.html(m?"Awarded: "+m+" players":""),e.css({top:f+"px",left:d+"px"}).show()},mouseleave:function(){e.hide()}},".achitem")})),$("#idnet-achievements").each((function(){var e=$(this),t=$("#achievements-template",e).html(),n=Handlebars.compile(t),i=$("#idnet-achievements-pagination"),o=$("body").data("idnet-app-id"),r={appid:o},s=[],a=0,c=!1,u=function(){e.find("abbr.timeago").timeago()},h=function(e,t){e.preventDefault(),m(t)},l=function(){jQuery.ajax({xhrFields:{withCredentials:!0},url:window.appInfo.accountServiceApiUrls.userAutologinUrl.replace(":app_id",o)}).done((function(t){var o;$(".achievements-loader").remove(),"user"in t&&(r.playerid=t.user.pid),o=function(t){if(!t.success||!("achievements"in t))return $(".idnet-achievements").hide(),!1;s=t.achievements,d(),(a=s.length>1?Math.ceil(s.length/16):1)>1&&i.twbsPagination({first:I18n.t("js.pagination.first",{defaultValue:"First"}),prev:I18n.t("js.pagination.previous",{defaultValue:"Previous"}),next:I18n.t("js.pagination.next",{defaultValue:"Next"}),last:I18n.t("js.pagination.last",{defaultValue:"Last"}),totalPages:a,visiblePages:13,onPageClick:h}),e.html(""),jQuery.each(s,(function(t,i){t<=15&&e.append(n(i))})),u()},ID.GameAPI.Achievements.listCustom(r,o),u()}))},d=function(){var e=[],t=[];jQuery.each(s,(function(n,i){"player"in i?e.push(i):t.push(i)})),s=e.concat(t)},f=function(t){var i=function(e){return s.slice(16*(e-1),16*e)}(t);jQuery.each(i,(function(t,i){e.append(n(i))}))},m=function(t){0==s.length?l():(e.html(""),f(t))};$(".idnet-achievements").visible(!0)?m(1):$(document).on("scroll",(function(){$(".idnet-achievements").visible(!0)&&0==c&&(m(1),c=!0)}))}))}};window.IdnetAchievements=e},8448:function(e,t,n){"use strict";n(4014);var i,o=function(e,t){return function(){return e.apply(t,arguments)}};window.Comments=function(){var e;function t(){}return e=void 0,t.init=function(){return null!=e?e:e=new i},t.instance=t.init,t}(),i=function(){function e(){this.onUserInfoReady(),this.hideErrorMessageContainer=o(this.hideErrorMessageContainer,this),this.showErrorMessageContainer=o(this.showErrorMessageContainer,this),this.hideSuccessMessageContainer=o(this.hideSuccessMessageContainer,this),this.showSuccessMessageContainer=o(this.showSuccessMessageContainer,this),this.errorMessageContainer=o(this.errorMessageContainer,this),this.successMessageContainer=o(this.successMessageContainer,this),this.commentFormContainer=o(this.commentFormContainer,this),this.setTimerToHideMessage=o(this.setTimerToHideMessage,this),this.showErrorMessage=o(this.showErrorMessage,this),this.showSuccessMessage=o(this.showSuccessMessage,this),this.disableForm=o(this.disableForm,this),this.enableForm=o(this.enableForm,this),this.onCommentSubmitError=o(this.onCommentSubmitError,this),this.onCommentSubmitSuccess=o(this.onCommentSubmitSuccess,this),this.onBeforeSend=o(this.onBeforeSend,this),this.onUserInfoReady=o(this.onUserInfoReady,this),this.onSubmitClick=o(this.onSubmitClick,this),this.registerHandlers=o(this.registerHandlers,this),this.registerHandlers()}return e.prototype.DEFAULT_ERROR_MESSAGE=I18n.t("views.items.show.comment-error",{defaultValue:"Unexpected error occurred, please try again."}),e.prototype.registerHandlers=function(){return $(document).on("user-info-ready",this.onUserInfoReady),this.commentFormContainer().find(".idnet-comments-form").on("ajax:beforeSend",this.onBeforeSend).on("ajax:success",this.onCommentSubmitSuccess).on("ajax:error",this.onCommentSubmitError),$("#submit-comment").on("click",this.onSubmitClick)},e.prototype.onSubmitClick=function(e){if(e.preventDefault(),$("#idnet-comment-text").val())return AvatarChooser.init((function(){return $(".idnet-comments-form").submit()}))},e.prototype.onUserInfoReady=function(){if("true"===Cookies.get("access_token")&&"true"===Cookies.get("logged_in"))return this.commentFormContainer().find(".login-to-comment").remove(),this.commentFormContainer().find(".post-comment-table").show(),this.commentFormContainer().find(".idnet-comment-text").attr("placeholder",I18n.t("views.items.show.comment-placeholder",{defaultValue:"Input your comment here"})),this.enableForm()},e.prototype.onBeforeSend=function(e){return this.disableForm(),!0},e.prototype.onCommentSubmitSuccess=function(e,t){return $("#idnet-comments").trigger("refresh"),$(".comments-counter").html(parseInt($(".comments-counter").html())+1),this.showSuccessMessage(t),this.enableForm({clear:!0})},e.prototype.onCommentSubmitError=function(e,t){return"You've already submitted a comment recently"==t.responseText?(this.showErrorMessage(I18n.t("views.items.show.comment-frequency",{defaultValue:"Please wait to post a comment again"})),this.enableForm({focus:!0})):(this.showErrorMessage(403===t.status&&$.trim(t.responseText).length>0?t.responseText:this.DEFAULT_ERROR_MESSAGE),this.enableForm({focus:!0}))},e.prototype.enableForm=function(e){var t;return null==e&&(e={}),t=this.commentFormContainer().find(".idnet-comment-text"),!0===e.clear&&t.val(""),t.prop("disabled",!1),!0===e.focus&&t.focus(),this.commentFormContainer().find(".comment-button").prop("disabled",!1)},e.prototype.disableForm=function(){return this.commentFormContainer().find(".idnet-comment-text").prop("disabled",!0),this.commentFormContainer().find(".comment-button").prop("disabled",!0)},e.prototype.showSuccessMessage=function(e){return this.hideErrorMessageContainer(),this.successMessageContainer().children("span").html(e),this.showSuccessMessageContainer(),this.setTimerToHideMessage()},e.prototype.showErrorMessage=function(e){return this.hideSuccessMessageContainer(),this.errorMessageContainer().children("span").html(e),this.showErrorMessageContainer(),this.setTimerToHideMessage()},e.prototype.setTimerToHideMessage=function(){return this.message_hiding_timeout&&clearTimeout(this.message_hiding_timeout),this.message_hiding_timeout=setTimeout((e=this,function(){return e.hideSuccessMessageContainer(),e.hideErrorMessageContainer()}),1e4);var e},e.prototype.commentFormContainer=function(){return this.comments_form_container||(this.comments_form_container=$(".post-comment-container"))},e.prototype.successMessageContainer=function(){return this.success_message_container||(this.success_message_container=this.commentFormContainer().find(".post-comment-message-success"))},e.prototype.errorMessageContainer=function(){return this.error_message_container||(this.error_message_container=this.commentFormContainer().find(".post-comment-message-error"))},e.prototype.showSuccessMessageContainer=function(){return this.successMessageContainer().removeClass("very-hidden").removeClass("hidden","fast")},e.prototype.hideSuccessMessageContainer=function(){return this.successMessageContainer().addClass("hidden","fast",(function(){return $(this).addClass("very-hidden")}))},e.prototype.showErrorMessageContainer=function(){return this.errorMessageContainer().removeClass("very-hidden").removeClass("hidden","fast")},e.prototype.hideErrorMessageContainer=function(){return this.errorMessageContainer().addClass("hidden","fast",(function(){return $(this).addClass("very-hidden")}))},e}();var r={init:function(){$("#idnet-comments").each((function(){var e=$(this),t=(e.data("idnet-comments-locale-script"),e.data("idnet-comments-url")),n=$("#comment-template",e).html(),i=Handlebars.compile(n),o=$("#idnet-comments-pagination"),r=function(e,t){e.preventDefault(),s(t)},s=function(n){jQuery.get(t,{page:n},(function(t){1==n&&Cookies.get("user_pid")?jQuery.get(e.data("idnet-user-comments-url").replace(":id",Cookies.get("user_pid")),a(t)):a(t)()}))},a=function(t){return function(n){$(".comments-loader, .spinner--comments").remove(),t=u(t),n=u(n);var s=t.pages_count>1?t.pages_count:1;s>1&&(o.show(),o.twbsPagination({first:I18n.t("js.pagination.first",{defaultValue:"First"}),prev:I18n.t("js.pagination.previous",{defaultValue:"Previous"}),next:I18n.t("js.pagination.next",{defaultValue:"Next"}),last:I18n.t("js.pagination.last",{defaultValue:"Last"}),totalPages:s,visiblePages:8,onPageClick:r}));var a=t.results;n&&n.results.length&&(a=c(a,n)),$(".comments-counter").html(t.count),e.empty().append($.map(a,(function(e){return e.message=decodeHtml(e.message),e.nickname?i(e):null}))),e.find(".timeago").timeago()}},c=function(e,t){var n=$.map(e,(function(e){return e._id}));return $.each(t.results.reverse(),(function(t,i){-1==n.indexOf(i._id)&&e.unshift(i)})),e},u=function(e){if("string"===typeof e)try{return jQuery.parseJSON(e)}catch(t){console.log("Failed to parse JSON",t,e)}return e};!function t(){e.visible(!0)?s(1):setTimeout(t,50)}(),e.on("refresh",(function(e){s(1)}))}))},dealWithSubmitButton:function(){var e=$("#idnet-comment-text"),t=$("#submit-comment");t.on("focus",(function(){t.trigger("click")})),e.on("focus",(function(){t.addClass("pre-active")})),e.on("focusout",(function(){t.removeClass("pre-active")})),e.on("keyup",(function(){$(this).val().length>2?(t.prop("disabled",!1),t.addClass("active")):(t.prop("disabled",!0),t.removeClass("active"))}))}};$((function(){Comments.init(),r.init(),["y8","videotime"].indexOf(window.appInfo.skinShortName)>=0&&r.dealWithSubmitButton()})),window.IdnetComments=r},4999:function(e,t,n){"use strict";n(861);var i,o,r,s,a,c,u,h,l,d=(s=function(){$.get(o,a).fail((function(e){$(".screenshots-loader, .spinner").fadeOut(),i.empty(),i.parent().hide(),console.log("Failed to load Y8 Account screenshots")}))},a=function(e){$(".screenshots-loader, .spinner").fadeOut(),e=l(e),i.html(""),e&&e.length?$.each(e,(function(e,t){i.append(r(t)),h(t,"#rateyo-")})):i.parent().hide(),$(".screenshot-thumb").on("click",c).each((function(){window.lazyload($(this)[0])})),$(".enlarged-screenshot-container").on("click",u),$(".enlarged-screenshot-close").on("click",u)},c=function(){var e=$(this).data("screenshot");$(".screenshot-table").hide((function(){var t=$(this);$(".enlarged-screenshot-container").fadeIn(),$(".enlarged-screenshot").attr({src:e.url}).on("load",(function(){var n=$("#enlarged-screenshot-template").html(),i=Handlebars.compile(n),o=t.find(".screenshot-info");o.on("click",(function(e){e.stopPropagation()})),o.empty(),o.append(i(e)),h(e,"#enlarged-rateyo-"),t.fadeIn()}))}))},u=function(){$(".enlarged-screenshot-container").fadeOut((function(){var e=$(".keycaptcha-wrapper");e.data("isDetached")&&($(".display-with-screenshot-rating-captcha").hide(),$(".keycaptcha-wrapper").detach().appendTo(".keycaptcha-placeholder"),e.data({isDetached:!1}))}))},h=function(e,t){var n=$(t+e.id);n.rateYo({rating:e.averageRating,starWidth:"15px",fullStar:!0,normalFill:"#CFDCE8"}),n.rateYo("option","onSet",(function(n){if("#enlarged-rateyo-"==t){var i=$(".keycaptcha-wrapper");i.detach().appendTo(".enlarged-keycaptcha-placeholder"),i.data({isDetached:!0})}ScreenshotRating.rate(e.appId,e.id,n)}))},l=function(e){if("string"===typeof e)try{e=$.parseJSON(e)}catch(t){}return e},{init:function(){Handlebars.registerHelper("contextAsJson",(function(){return JSON.stringify(this)})),$(".idnet-screenshots").each((function(){i=$(this),o=i.data("idnet-screenshots-url");var e=$("#screenshot-template",i).html();r=Handlebars.compile(e),function e(){i.visible(!0)?s():setTimeout(e,50)}()}))},initForProfile:function(){$(".screenshot").on("click",c).each((function(){window.lazyload($(this)[0])})),$(".enlarged-screenshot-container").on("click",u),$(".enlarged-screenshot-close").on("click",u)}});$((function(){d.init()})),window.IdnetScreenshots=d},3070:function(){window.ItemDiv=function(e,t){this.domId=e,this.$domElt=$(e),this.$container=t.$domElt,this.initialWidth=this.$container.data("item-width"),this.initialHeight=this.$container.data("item-height"),this.supportsResizing=this.$container.data("item-supports-resizing"),this.ratioTolerant=this.$container.data("item-ratio-tolerant"),this.ratio=this.initialWidth/this.initialHeight,this.maximize=1==this.$container.data("maximize"),this.initialFitWidth=null,this.intialFitHeight=null,this.initialFitRatio=null,this.fitInto=function(e,t,n){t="undefined"!==typeof t?t:0,n="undefined"!==typeof n?n:0;var i={};if(this.supportsResizing)return(i=this.ratioTolerant?{width:e.currentWidth(),height:e.currentHeight()}:this.ratio>e.currentRatio()?{width:e.currentWidth(),height:e.currentWidth()/this.ratio}:{width:e.currentHeight()*this.ratio,height:e.currentHeight()}).width=i.width-t,i.height=i.height-n,this.changeSizeWith(i),i},this.initFitSize=function(e){this.initialFitWidth||(this.initialFitWidth=e.width||this.initialWidth,this.initialFitHeight=e.height||this.initialHeight,this.initialFitRatio=this.initialFitWidth/this.initialFitHeight)},this.changeSizeWith=function(e){if(e!={}){this.$domElt.each((function(){$(this).width(e.width),$(this).height(e.height),"mobile"==window.UserAgent.device.type&&($(this).css("max-width",e.width),$(this).css("max-height",e.height))}));var t=$("#afgv");t.css(e).attr(e),t.find("embed").css(e).attr(e)}},this.currentWidth=function(){return this.$domElt.length?this.$domElt.width():this.initialWidth},this.currentHeight=function(){return this.$domElt.length?this.$domElt.height():this.initialHeight},this.refreshDom=function(){this.$domElt=$(this.domId)}},window.ContainerDiv=function(e){this.$domElt=$(e),this.initialWidth=this.$domElt.width(),this.initialHeight=this.$domElt.height(),this.initialRatio=this.initialWidth/this.initialHeight,this.currentWidth=function(){return this.$domElt.width()},this.currentHeight=function(){return this.$domElt.height()},this.currentRatio=function(){return this.currentWidth()/this.currentHeight()}}},100:function(){var e={init:function(){$("body").on("click",".item-embed-toggle",this.popUp.bind(this)),$("body").on("click",".item-embed-popup .btn-close",this.hideAll.bind(this)),$("body").on("click",".btn-copy-code",this.copyCode.bind(this))},popUp:function(e){e.stopPropagation(),e.preventDefault();var t=$(e.currentTarget).data("item-id");$popup=$("#item-embed-popup-"+t),$popup.toggle(),this.selectEmbedCode(e)},hideAll:function(e){e.preventDefault(),$(".item-embed-popup").hide()},selectEmbedCode:function(e){$(e.target).parent().find("textarea").select()},copyCode:function(e){e.preventDefault()}};window.ItemEmbed=e},9185:function(e,t,n){"use strict";n(5785);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o(i.key),i)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}var r=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.favorite=new Favorite,this.userInfo=new UserInfo},t=[{key:"bindClickActions",value:function(){var e=this;$(".favorites_add, .favorites_remove, .hearted_add, .hearted_remove").on("click",(function(t){return t.preventDefault(),e.$currentActionContainer=$(t.currentTarget),e.currentAction=e.$currentActionContainer.data("action"),e.$container=e.$currentActionContainer.closest(".fav-part"),e.$add=e.$container.find(".favorites_add"),e.$remove=e.$container.find(".favorites_remove"),e.$heart=e.$container.find(".hearted_add"),e.$unheart=e.$container.find(".hearted_remove"),e.$heartMessage=$(".heart-message"),e.perform(),!1}))}},{key:"perform",value:function(){if(this.favorite.processing)return!1;this.favorite[this.currentAction](this.getUrl(this.$currentActionContainer),this.getItemId(this.$currentActionContainer),$.proxy(this[this.currentAction],this))}},{key:"add",value:function(e){this.$add.hide(),this.$remove.show(),this.userInfo.canHeart()?(this.$heart.addClass("show"),this.$unheart.removeClass("visible"),this.$heartMessage.addClass("animation"),setTimeout((function(){return $(".heart-message").removeClass("animation")}),7e3)):(this.$heartMessage.removeClass("show"),this.$unheart.removeClass("visible")),$(document).triggerHandler("favorites-count",e.user_favorites_count)}},{key:"remove",value:function(e){this.$add.show(),this.$remove.hide(),this.$heart.show().removeClass("show").removeClass("visible"),this.$unheart.show().removeClass("visible").removeClass("show"),this.$heartMessage.removeClass("animation"),$(document).triggerHandler("favorites-count",e.user_favorites_count),$(document).triggerHandler("hearts-count",e.user_hearts_count)}},{key:"heart",value:function(e){this.$heart.hide().removeClass("visible").removeClass("show"),this.$unheart.addClass("visible"),$(document).triggerHandler("hearts-count",e.user_hearts_count)}},{key:"unheart",value:function(e){this.$heart.addClass("visible"),this.$unheart.hide().removeClass("visible").removeClass("show"),$(document).triggerHandler("hearts-count",e.user_hearts_count)}},{key:"getUrl",value:function(e){return e.data("url")}},{key:"getItemId",value:function(e){return e.data("item-id")}}],t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();window.ItemFavorite=r},7829:function(e,t){"use strict";function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,i(o.key),o)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}var o=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cookieExpiration=365,this.maxIds=100,this.allowedSkins=["y8","videotime"],this.cookieName=t,this.cookieVal=Cookies.get(t),this.saveGameId(n)},(t=[{key:"saveGameId",value:function(e){if(!(this.allowedSkins.indexOf(window.appInfo.skinShortName)<0)){var t=this.cookieVal?JSON.parse(this.cookieVal):[],n=t.indexOf(e);n>-1&&t.splice(n,1),t.push(e),t.length>this.maxIds&&t.splice(0,1),this.storeCookie(t)}}},{key:"storeCookie",value:function(e){var t=Object.assign(window.appInfo.commonCookieOptions,{expires:this.cookieExpiration});Cookies.set(this.cookieName,JSON.stringify(e),t)}}])&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();t.A=o},3839:function(){function e(e,n){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){i&&(e=i);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){c=!0,s=e},f:function(){try{a||null==i.return||i.return()}finally{if(c)throw s}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,i(o.key),o)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}!function(t,i){"use strict";var o=[],r=[],s=function(){return t=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.stopPropagation(),t.preventDefault(),this.$button=i(t.currentTarget),this.direction=n,this.itemId=this.$button.data("item-id")},s=[{key:"submit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];VotingButtons.disable();var n=(new UserInfo).isLoggedIn(),i=t.some((function(e){return"cf-turnstile-response"===e.name})),o=function(t){return Voting.vote(e.itemId,e.direction,t).then(e.onSuccess.bind(e),e.onFailure.bind(e))};n||i?o(t):window.RecaptchaV3.triggerAction("vote").then((function(e){return o(e?t.concat([{name:"cf-turnstile-response",value:e}]):t)}))}},{key:"callCallbacks",value:function(t,n){var i,o=e(t);try{for(o.s();!(i=o.n()).done;)i.value.apply(this.$button,n)}catch(r){o.e(r)}finally{o.f()}}},{key:"onSuccess",value:function(){this.callCallbacks(o,arguments)}},{key:"onFailure",value:function(e,t){var n=arguments,i=this;t==Voting.ERROR_NOT_LOGGED_IN_AND_NO_CAPTCHA?window.RecaptchaV3.triggerAction("vote").then((function(e){if(!e)return i.callCallbacks(r,n),void VotingButtons.enable();i.submit([{name:"cf-turnstile-response",value:e}])})):(this.callCallbacks(r,arguments),VotingButtons.enable())}},{key:"saveIdToCookies",value:function(){var e=i(".animations-active").length?"videos":"games";new LibraryCookieSetter("liked_"+e+"_ids",this.itemId)}}],s&&n(t.prototype,s),a&&n(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,s,a}(),a=function(e){if(!i(e.currentTarget).hasClass("is-disabled")){var t=new s(e,"up");t.submit(),(new UserInfo).isLoggedIn()||t.saveIdToCookies(t.itemId)}},c=function(e){i(e.currentTarget).hasClass("is-disabled")||new s(e,"down").submit()};t.DesktopVoting={onSuccess:function(e){o.push(e)},onFailure:function(e){r.push(e)},init:function(){Voting.init(),i("#voting-button-yes").on("click",a),i("#voting-button-no").on("click",c),VotingButtons.enable()}}}(window,jQuery)},6730:function(e,t,n){"use strict";n(872),n(428),n(3839);var i=n(7829);window.LibraryCookieSetter=i.A,function(e,t){var n;function i(e){return r("success"),e}function o(e,n){var i=function(e){try{if(400!=e.status)return;return t.parseJSON(e.responseText).error.code}catch(n){return}}(n);switch(i){case self.ERROR_NOT_LOGGED_IN_AND_NO_CAPTCHA:break;case self.ERROR_TOO_MANY_VOTES_PER_ITEM:r("no-more");break;case self.ERROR_TOO_MANY_VOTES_PER_SITE:r("max-reached");break;default:r("unknown-error",!0)}return t.Deferred().reject(e,i)}function r(e,n){if(e){t("#voting-message-no-more").hide(),t("#voting-message-max-reached").hide(),t("#voting-message-unknown-error").hide();var i=t("#voting-message-"+e);0!==i.length&&(i.fadeIn(),n&&setTimeout("VotingButtons.enable()",5e3))}}e.Voting={ERROR_NOT_LOGGED_IN_AND_NO_CAPTCHA:1,ERROR_TOO_MANY_VOTES_PER_ITEM:2,ERROR_TOO_MANY_VOTES_PER_SITE:3,init:function(){n=t.now()},vote:function(e,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=(t.now()-n)/1e3;return new VotingRequest(e,r,a,s).send().then(i,o)}}}(window,jQuery)},872:function(){!function(e,t){"use strict";var n={get container(){return delete this.container,this.container=t("#voting-buttons-container")},get buttons(){return delete this.buttons,this.buttons=this.container.find("button, #voting-button-yes, #voting-button-no")}};e.VotingButtons={enable:function(){n.buttons.prop("disabled",!1).removeClass("is-disabled").attr("aria-disabled","false")},disable:function(){n.buttons.prop("disabled",!0).addClass("is-disabled").attr("aria-disabled","true")}}}(window,jQuery)},428:function(){function e(e,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,t(o.key),o)}}function t(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}var n=function(){return t=function e(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.itemId=t,this.type=n,this.data=o.concat([{name:"item_id",value:t},{name:"vote_type",value:n},{name:"vote_time",value:i}]),this.deferred=$.Deferred()},(n=[{key:"send",value:function(){return $.ajax({url:"/ajax/vote",type:"POST",data:this.data,timeout:1e4,complete:this.complete.bind(this)}),this.deferred.promise()}},{key:"complete",value:function(e,t){this.deferred["success"==t?"resolve":"reject"](this,e)}}])&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,i}();window.VotingRequest=n},4085:function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}function t(e,t,i){return(t=n(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}!function(n){"use strict";var i=t(t(t({},Voting.ERROR_TOO_MANY_VOTES_PER_ITEM,"items.voting_main.vote_no_more"),Voting.ERROR_TOO_MANY_VOTES_PER_SITE,"views.items.show.max_votes_reached"),"default","views.items.show.unknown_voting_error"),o=function(){return t=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$button=t,this.errorCode=n},(o=[{key:"position",value:function(){return{left:this.$button.position().left}}},{key:"show",value:function(){var e=I18n.t(this.key()),t=this.position();n(".vote-popup").show().html(e).css(t).slideDown().delay(8e3).fadeOut()}},{key:"showOverlay",value:function(){var e=this.position();n("#success-overlay").show().css(e).delay(6e3).fadeOut()}},{key:"key",value:function(){return i[this.errorCode]||i.default}}])&&e(t.prototype,o),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,o,r}();DesktopVoting.onSuccess((function(){var e=n(this),t=e.data("success-class");e.addClass(t),n(".on-success",e).show(),new o(e).showOverlay()})),DesktopVoting.onFailure((function(e,t){new o(this,t).show()}))}(jQuery)}}]);